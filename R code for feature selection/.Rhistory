setwd("C:/Users/Derek/CS3244 data/R code for feature selection")
library(glmnet)
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(iterators)
library(foreach)
library(Matrix)
library(shape)
library(glmnet)
library(dplyr)
library(MASS)
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(iterators)
library(foreach)
library(Matrix)
library(shape)
library(glmnet)
library(dplyr)
library(MASS)
```
library(glmnet)
library(dplyr)
library(MASS)
setwd("C:/Users/Derek/CS3244 data/R code for feature selection")
library(MASS)
knitr::opts_chunk$set(echo = TRUE)
library(iterators)
library(foreach)
library(Matrix)
library(shape)
library(glmnet)
library(dplyr)
library(MASS)
data <- read.csv('/final.csv')
data <- read.csv('final.csv')
View(data)
data <- data[,2:26]
data$town <- as.factor(data$town)
data$flat_model <-as.factor(data$flat_model )
data$flat_type <-as.factor(data$flat_type )
data <- data %>%
mutate(top = as.numeric(substr(storey_range, start = 1, stop = 2))) %>%
mutate(bottom = as.numeric(substr(storey_range, nchar(storey_range)-1, nchar(storey_range))))%>%
mutate(storey_range = (top+bottom)/2) %>%
dplyr::select(-top,-bottom)
x = as.matrix(data[,-8])
y = as.vector(data$resale_price)
fit1 = cv.glmnet(x, y)
coef(fit1, s = fit1$lambda.min)
View(x)
forward=stepAIC(fit.1,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+address+floor_area_sqm+flat_model+lease_commence_date+years.x+years.y+index+years+Lat+Lon+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker,
lower=~1),direction="forward")
x2 <- data[-address]
data <- read.csv('final.csv')
data <- data[,2:26]
data$town <- as.factor(data$town)
data$flat_model <-as.factor(data$flat_model )
data$flat_type <-as.factor(data$flat_type )
data <- data %>%
mutate(top = as.numeric(substr(storey_range, start = 1, stop = 2))) %>%
mutate(bottom = as.numeric(substr(storey_range, nchar(storey_range)-1, nchar(storey_range))))%>%
mutate(storey_range = (top+bottom)/2) %>%
dplyr::select(-top,-bottom)
y2 <- data$resale_price
x2 <- data[,-12]
x2 <- data[,c(-12,-15)]
View(x2)
x2 <- data[,c(-12,-15)] %>%
mutate(across(dist_presch:dist_hawker, log))
data2 <- cbind(x2,y2)
x2 <- data[,c(-12,-15)] %>%
mutate(across(dist_presch:dist_hawker, log))
data2 <- cbind(x2,y2)
fit.1 = lm(y~1, data = data2)
forward=stepAIC(fit.1,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+lease_commence_date+years+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="forward")
fit.2 = lm(y~month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+lease_commence_date+years+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data = data2)
backward=stepAIC(fit.2,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+lease_commence_date+years+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="backward")
y2 <- data$resale_price
y <- data$resale_price
fit.2 = lm(y~month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+years+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data = data2)
forward=stepAIC(fit.1,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+years+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="forward")
backward=stepAIC(fit.2,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+years+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="backward")
fit.2 = lm(y~month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data = data2)
forward=stepAIC(fit.1,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="forward")
backward=stepAIC(fit.2,scope=list(upper=~+month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="backward")
fit.3 <- lm(y~month+town+flat_type+storey_range+year+remaining_lease+quarter+address+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data=data2)
fit.3 <- lm(y~month+town+flat_type+storey_range+year+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data=data2)
summary(fit.3)
anova(fit.3)
fit.1 = lm(y~1, data = data2)
fit.2 = lm(y~month+town+flat_type+storey_range+years+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data = data2)
forward=stepAIC(fit.1,scope=list(upper=~+month+town+flat_type+storey_range+years+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="forward")
backward=stepAIC(fit.2,scope=list(upper=~+month+town+flat_type+storey_range+years+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, lower=~1),direction="backward")
fit.3 <- lm(y~month+town+flat_type+storey_range+years+remaining_lease+quarter+floor_area_sqm+flat_model+dist_presch+dist_gym+dist_kinder+dist_park+dist_park+dist_mrt+dist_hawker, data=data2)
summary(fit.3)
anova(fit.3)
